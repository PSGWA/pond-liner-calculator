<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ ‡∏ú‡πâ‡∏≤‡∏õ‡∏π‡∏ö‡πà‡∏≠ ‚Ä¢ ‡∏Ñ‡∏•‡∏≠‡∏á‡πÑ‡∏™‡πâ‡πÑ‡∏Å‡πà ‚Ä¢ ‡∏ö‡πà‡∏≠‡∏Å‡∏•‡∏° ‚Ä¢ ‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô ‚Ä¢ ‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</title>
  <style>
    :root{
      --clr-primary:#2563eb; --clr-primary-dark:#1d4ed8; --clr-secondary:#60a5fa;
      --clr-danger:#dc2626; --clr-warning:#facc15; --clr-bg:#ffffff; --clr-card:#ffffff;
      --clr-muted:#6b7280; --shadow:0 8px 20px rgba(0,0,0,.06); --radius:12px;
    }
    *{box-sizing:border-box;font-family:'Segoe UI', Tahoma, Arial, sans-serif}
    body{margin:0;background:var(--clr-bg);color:#111827}
    h1{ text-align:center; margin:26px 0 18px; font-size:26px; }
    .tabs{ display:flex; justify-content:center; gap:10px; flex-wrap:wrap; margin:0 0 18px; }
    .tab{ padding:10px 18px; cursor:pointer; background:#fff; border-radius:0; border:1px solid #e5e7eb; transition:.25s; font-weight:600; color:#111827 }
    .tab:hover{ background:#f3f4f6; }
    .tab.active{ background:var(--clr-primary); color:#fff; border-color:var(--clr-primary); }

    .container{ max-width:980px; margin:0 auto 40px; padding:24px; background:var(--clr-card); border-radius:var(--radius); box-shadow:var(--shadow); }
    label{ display:block; margin-bottom:8px; font-weight:600; }
    .radio-group{ display:flex; flex-wrap:wrap; gap:10px; margin-bottom:14px; }

    input[type="number"], input[type="text"], select, textarea{ width:100%; padding:14px 16px; border:1px solid #e5e7eb; border-radius:10px; margin-bottom:16px; font-size:16px; line-height:1.4; min-height:46px; background:#fff; transition:border-color .2s ease, box-shadow .2s ease; }
    input[type="number"]:focus, input[type="text"]:focus, select:focus, textarea:focus{ outline:none; border-color:#93c5fd; box-shadow:0 0 0 3px rgba(147,197,253,.35); }

    textarea{ resize:none; background:#f9fafb; min-height:140px; }

    button{ border:none; border-radius:10px; padding:12px 18px; font-size:15px; font-weight:600; cursor:pointer; transition:.25s; }
    .btn-primary{ background:var(--clr-primary); color:#fff; } .btn-primary:hover{ background:var(--clr-primary-dark); }
    .btn-secondary{ background:var(--clr-secondary); color:#fff; }
    .btn-warning{ background:var(--clr-warning); color:#111; }
    .btn-danger{ background:var(--clr-danger); color:#fff; }
    .copy-btn{ display:inline-flex; align-items:center; gap:8px; padding:10px 16px; border-radius:10px; background:var(--clr-secondary); color:#fff; font-weight:700; }
    .copy-btn:hover{ filter:brightness(.96); }

    .hidden{ display:none; }

    .items-table{ width:100%; border-collapse:collapse; margin-bottom:14px; border:1px solid #e5e7eb; border-radius:10px; overflow:hidden; }
    .items-table thead{ background:var(--clr-primary); color:#fff; }
    .items-table th, .items-table td{ padding:10px; text-align:center; }
    .items-table tbody tr:nth-child(odd){ background:#f8fafc; }
    .items-table th:first-child, .items-table td:first-child{ min-width: 180px; }
    .items-table input[type="number"], .items-table select{ color:#111827 !important; -webkit-text-fill-color:#111827; background:#fff; width:100%; height:52px; font-size:18px; padding:10px 12px; text-align:center; }
    .items-table input::placeholder{ color:#9ca3af; }

    /* ‡∏Ç‡∏¢‡∏≤‡∏¢‡∏Ñ‡∏≠‡∏•‡∏±‡∏°‡∏ô‡πå‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡πÉ‡∏´‡πâ‡πÉ‡∏´‡∏ç‡πà‡∏Ç‡∏∂‡πâ‡∏ô‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÅ‡∏•‡∏∞‡πÄ‡∏î‡∏™‡∏Å‡πå‡∏ó‡πá‡∏≠‡∏õ */
    .items-table td:nth-child(2), /* ‡∏Å‡∏ß‡πâ‡∏≤‡∏á */
    .items-table td:nth-child(3), /* ‡∏¢‡∏≤‡∏ß */
    .items-table td:nth-child(4), /* ‡∏•‡∏∂‡∏Å */
    .items-table td:nth-child(6)  /* ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô */{ min-width:120px; }

    .hint{color:#6b7280; font-size:13px; margin:8px 0 10px; line-height:1.55; word-break:break-word; }
    .row{display:grid; grid-template-columns: 1fr 1fr; gap:12px;}

    @media (max-width:600px){
      .container{ padding:14px; }
      .tab{ padding:8px 14px; font-size:14px; }
      button{ font-size:16px; }
      .items-table{ display:block; overflow-x:auto; }
      .row{ grid-template-columns:1fr; }
      /* ‡∏Ç‡∏¢‡∏≤‡∏¢ input ‡πÅ‡∏•‡∏∞ select ‡∏ö‡∏ô‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÉ‡∏´‡πâ‡∏°‡∏≠‡∏á‡πÄ‡∏´‡πá‡∏ô‡∏ä‡∏±‡∏î ‡πÑ‡∏°‡πà‡πÇ‡∏î‡∏ô‡∏ã‡∏π‡∏° */
      input[type="number"], input[type="text"], select, textarea{ font-size:18px; min-height:52px; }
      .items-table input[type="number"], .items-table select{ height:56px; font-size:20px; }
      .items-table th, .items-table td{ padding:12px; }
      .items-table td:nth-child(2), .items-table td:nth-child(3), .items-table td:nth-child(4), .items-table t .tab{ padding:8px 14px; font-size:14px; } button{ font-size:14px; } .items-table{ display:block; overflow-x:auto; } .row{ grid-template-columns:1fr; } }
  </style>
</head>
<body>
  <h1>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡πà‡∏≤ ‡∏ú‡πâ‡∏≤‡∏õ‡∏π‡∏ö‡πà‡∏≠ / ‡∏Ñ‡∏•‡∏≠‡∏á‡πÑ‡∏™‡πâ‡πÑ‡∏Å‡πà / ‡∏ö‡πà‡∏≠‡∏Å‡∏•‡∏° / ‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô / ‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h1>
  <div class="tabs">
    <div class="tab active" data-tab="pond">‡∏ö‡πà‡∏≠‡∏Ç‡∏∏‡∏î</div>
    <div class="tab" data-tab="canal">‡∏Ñ‡∏•‡∏≠‡∏á‡πÑ‡∏™‡πâ‡πÑ‡∏Å‡πà</div>
    <div class="tab" data-tab="circular">‡∏ö‡πà‡∏≠‡∏Å‡∏•‡∏°</div>
    <div class="tab" data-tab="flatbar">‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô</div>
    <div class="tab" data-tab="summary">‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</div>
  </div>

  <!-- POND -->
  <div class="container" id="pondContainer">
    <form id="pondForm">
      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤ (‡∏°‡∏°.):</label>
      <div class="radio-group">
        <label><input type="radio" name="size" value="0.3" required> 0.3 ‡∏°‡∏°.</label>
        <label><input type="radio" name="size" value="0.5" required> 0.5 ‡∏°‡∏°.</label>
        <label><input type="radio" name="size" value="0.75" required> 0.75 ‡∏°‡∏°.</label>
        <label><input type="radio" name="size" value="all" required> ‡πÑ‡∏°‡πà‡∏£‡∏∞‡∏ö‡∏∏‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤</label>
      </div>

      <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á (‡πÄ‡∏°‡∏ï‡∏£):</label>
      <input type="number" id="pondWidth" step="0.01" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á" required>

      <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß (‡πÄ‡∏°‡∏ï‡∏£):</label>
      <input type="number" id="pondLength" step="0.01" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß" required>

      <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (‡πÄ‡∏°‡∏ï‡∏£, ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):</label>
      <input type="number" id="pondDepth" step="0.01" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">

      <label><input type="checkbox" id="pondSpecialProvince" value="yes"> ‡∏™‡πà‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á ‡∏™‡∏ï‡∏π‡∏• ‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ ‡∏¢‡∏∞‡∏•‡∏≤ ‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™ (‡πÄ‡∏û‡∏¥‡πà‡∏° 5 ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°. ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 2,000)</label>
      <label><input type="checkbox" id="pondDiscount5" value="yes"> ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 5%</label>
      <label><input type="checkbox" id="pondFactoryBlue" value="yes"> ‡πÄ‡∏û‡∏à "‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô" (‡πÉ‡∏ä‡πâ‡∏£‡∏≤‡∏Ñ‡∏≤ 40/60/80 ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)</label>
      <div class="hint">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô: 0.3 = 40, 0.5 = 60, 0.75 = 80 ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.</div>

      <button type="submit" class="btn-primary">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
      <button type="button" id="pondReset" class="btn-warning hidden">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</button>
    </form>

    <textarea id="pondResult" readonly placeholder="‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>
    <button id="pondCopy" class="copy-btn hidden">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
  </div>

  <!-- CANAL -->
  <div class="container hidden" id="canalContainer">
    <form id="canalForm">
      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤ (‡∏°‡∏°.):</label>
      <div class="radio-group">
        <label><input type="radio" name="canalSize" value="0.5" required> 0.5 ‡∏°‡∏°. (LDPE)</label>
      </div>
      <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á (‡πÄ‡∏°‡∏ï‡∏£):</label>
      <input type="number" id="canalWidth" step="0.01" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á" required>
      <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß (‡πÄ‡∏°‡∏ï‡∏£):</label>
      <input type="number" id="canalLength" step="0.01" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß" required>
      <label>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (‡πÄ‡∏°‡∏ï‡∏£, ‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):</label>
      <input type="number" id="canalDepth" step="0.01" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å (‡∏ñ‡πâ‡∏≤‡∏°‡∏µ)">
      <label><input type="checkbox" id="canalSpecialProvince" value="yes"> ‡∏™‡πà‡∏á‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏±‡∏ó‡∏•‡∏∏‡∏á ‡∏™‡∏ï‡∏π‡∏• ‡∏õ‡∏±‡∏ï‡∏ï‡∏≤‡∏ô‡∏µ ‡∏¢‡∏∞‡∏•‡∏≤ ‡∏ô‡∏£‡∏≤‡∏ò‡∏¥‡∏ß‡∏≤‡∏™ (‡πÄ‡∏û‡∏¥‡πà‡∏° 5 ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)</label>
      <label><input type="checkbox" id="canalDiscount5" value="yes"> ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 5%</label>
      <label><input type="checkbox" id="canalFactoryBlue" value="yes"> ‡πÄ‡∏û‡∏à "‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô" (LDPE 0.5 = 50 ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)</label>

      <button type="submit" class="btn-primary">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì</button>
      <button type="button" id="canalReset" class="btn-warning hidden">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</button>
    </form>

    <textarea id="canalResult" readonly placeholder="‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>
    <button id="canalCopy" class="copy-btn hidden">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
  </div>

  <!-- CIRCULAR -->
  <div class="container hidden" id="circularContainer">
    <form id="circularForm">
      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á (‡πÄ‡∏°‡∏ï‡∏£):</label>
      <div class="radio-group">
        <label><input type="radio" name="circleDiameter" value="6" required> 6 ‡πÄ‡∏°‡∏ï‡∏£</label>
        <label><input type="radio" name="circleDiameter" value="8" required> 8 ‡πÄ‡∏°‡∏ï‡∏£</label>
        <label><input type="radio" name="circleDiameter" value="10" required> 10 ‡πÄ‡∏°‡∏ï‡∏£</label>
        <label><input type="radio" name="circleDiameter" value="12" required> 12 ‡πÄ‡∏°‡∏ï‡∏£</label>
      </div>
      <button type="submit" class="btn-primary">‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</button>
      <button type="button" id="circularReset" class="btn-warning hidden">‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà</button>
    </form>
    <textarea id="circularResult" readonly placeholder="‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>
    <button id="circularCopy" class="copy-btn hidden">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
  </div>

  <!-- FLATBAR -->
  <div class="container hidden" id="flatbarContainer">
    <form id="flatbarForm">
      <label>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö (‡∏ä‡∏∑‡πà‡∏≠-‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà-‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£)</label>
      <textarea id="flatbarCustInfo" placeholder="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>

      <h3 style="margin-top:0">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤ (‡∏à‡∏≥‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1)</h3>
      <table class="items-table" id="clothTableFlatbar">
        <thead>
          <tr>
            <th>‡πÅ‡∏ö‡∏ö</th>
            <th>‡∏Å‡∏ß‡πâ‡∏≤‡∏á (‡∏°.)</th>
            <th>‡∏¢‡∏≤‡∏ß (‡∏°.)</th>
            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
            <th>‡∏•‡∏ö</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <button type="button" id="flatbarAddCloth" class="btn-secondary" style="margin-bottom:8px">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤</button>
      <div class="hint">‡∏Ñ‡πà‡∏≤‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô "‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á" (‡∏Ñ‡∏¥‡∏î 250 ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.) ‚Ä¢ ‡∏ñ‡πâ‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÅ‡∏ö‡∏ö‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡∏Å‡∏£‡∏≠‡∏Å‡∏Å‡∏ß‡πâ‡∏≤‡∏á√ó‡∏¢‡∏≤‡∏ß‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏Ñ‡∏¥‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏≤‡∏°‡∏ä‡∏∏‡∏î‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à</div>
      <label><input type="checkbox" id="flatbarDiscount5"> ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 5% (‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡πâ‡∏≤)</label>
      <hr style="opacity:.25; margin:16px 0">

      <label>‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)</label>
     <div class="hint">
  ‡∏™‡∏π‡∏ï‡∏£‡∏£‡∏≤‡∏Ñ‡∏≤‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô: (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏£‡∏ñ √ó 50 √ó 4) + ‡πÄ‡∏´‡∏•‡πä‡∏Å‡∏ï‡∏¥‡∏î‡∏´‡∏±‡∏ß‡∏ó‡πâ‡∏≤‡∏¢ 300 ‡∏ö‡∏≤‡∏ó ‡πÅ‡∏•‡∏∞ +150 ‡∏ö‡∏≤‡∏ó/‡∏Ñ‡∏±‡∏ô ‡∏ñ‡πâ‡∏≤ "‡∏°‡∏µ‡∏ú‡πâ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤"
  ‚Ä¢ ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏π‡∏ì 4 ‡∏à‡∏∏‡∏î ‚Ä¢ ‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏¢‡∏≤‡∏ß 2 ‡∏°./3 ‡∏°. ‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
</div>
      <h4 style="margin:8px 0">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô</h4>
      <table class="items-table" id="flatbarItemsTable">
     <thead>
  <tr>
    <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏£‡∏ñ :(‡∏°.)</th>
    <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡∏£‡∏ñ (‡∏°.)</th>
    <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏±‡∏ô</th>
    <th>‡∏•‡∏ö</th>
  </tr>
</thead>
        <tbody></tbody>
      </table>
      <button type="button" id="addFlatbarRow" class="btn-secondary" style="margin-bottom:8px">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô</button>
      <label><input type="checkbox" id="hasFrontCloth"> ‡∏°‡∏µ‡∏ú‡πâ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏î‡πâ‡∏≤‡∏ô‡∏´‡∏ô‡πâ‡∏≤ (+150 ‡∏ö‡∏≤‡∏ó/‡∏ä‡∏∏‡∏î)</label>

      <div class="row">
        <div>
          <label>Facebook (‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤)</label>
          <input type="text" id="flatbarFacebook" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏¢‡∏≠‡∏î‡∏ä‡∏≤‡∏¢ ‡πÄ‡∏ù‡∏î‡∏™‡∏π‡∏á‡πÄ‡∏ô‡∏¥‡∏ô">
        </div>
        <div>
          <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà (‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á)</label>
          <input type="text" id="flatbarDate" placeholder="‡πÄ‡∏ä‡πà‡∏ô 20/8/68">
        </div>
      </div>

      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à</label>
      <select id="flatbarPageSelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à...</option>
        <option value="‡∏™‡πâ‡∏°">‡∏™‡πâ‡∏°</option>
        <option value="‡∏°‡πà‡∏ß‡∏á">‡∏°‡πà‡∏ß‡∏á</option>
        <option value="‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô">‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</option>
        <option value="‡∏ö‡πà‡∏≠‡πÉ‡∏´‡∏ç‡πà">‡∏ö‡πà‡∏≠‡πÉ‡∏´‡∏ç‡πà</option>
        <option value="‡∏£‡∏ñ‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å">‡∏£‡∏ñ‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å</option>
        <option value="MP">MP</option>
        <option value="‡πÇ‡∏ó‡∏£">‡πÇ‡∏ó‡∏£</option>
        <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏ü‡∏™ (‡πÄ‡∏ï‡∏¢)">‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏ü‡∏™ (‡πÄ‡∏ï‡∏¢)</option>
        <option value="PP Dump">PP Dump</option>
        <option value="‡πÄ‡∏ã‡∏ü‡∏ó‡∏£‡∏±‡∏Å">‡πÄ‡∏ã‡∏ü‡∏ó‡∏£‡∏±‡∏Å</option>
        <option value="Line">Line</option>
      </select>

      <label>‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</label>
      <select id="flatbarAdminSelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô...</option>
        <option value="‡∏´‡∏°‡∏¥‡∏ß">‡∏´‡∏°‡∏¥‡∏ß</option>
        <option value="‡πÄ‡∏ï‡∏¢">‡πÄ‡∏ï‡∏¢</option>
        <option value="‡∏à‡πã‡∏≤">‡∏à‡πã‡∏≤</option>
        <option value="‡πÄ‡∏ö‡∏•">‡πÄ‡∏ö‡∏•</option>
        <option value="‡∏´‡∏á‡∏™‡πå">‡∏´‡∏á‡∏™‡πå</option>
        <option value="‡∏†‡∏µ‡∏£‡πå">‡∏†‡∏µ‡∏£‡πå</option>
        <option value="‡∏Å‡∏°‡∏•">‡∏Å‡∏°‡∏•</option>
        <option value="pekky">pekky</option>
        <option value="‡∏û‡∏•‡∏≠‡∏¢">‡∏û‡∏•‡∏≠‡∏¢</option>
        <option value="‡πÅ‡∏à‡∏°">‡πÅ‡∏à‡∏°</option>
        <option value="‡πÉ‡∏¢‡∏ù‡πâ‡∏≤‡∏¢">‡πÉ‡∏¢‡∏ù‡πâ‡∏≤‡∏¢</option>
      </select>

      <button type="submit" class="btn-primary" style="margin-top:12px">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÅ‡∏•‡∏∞‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏∏‡∏õ</button>
      <button type="button" id="flatbarReset" class="btn-warning hidden">‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡πÉ‡∏´‡∏°‡πà</button>
    </form>
    <textarea id="flatbarResult" readonly placeholder="‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>
    <button id="flatbarCopy" class="copy-btn hidden">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
  </div>

  <!-- SUMMARY (‡πÑ‡∏°‡πà‡∏£‡∏ß‡∏°‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô) -->
  <div class="container hidden" id="summaryContainer">
    <form id="summaryForm">
      <label>‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö (‡∏ä‡∏∑‡πà‡∏≠-‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà-‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£)</label>
      <textarea id="custInfo" placeholder="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏°‡∏≤‡∏ß‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà"></textarea>

      <h3 style="margin-top:0">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤</h3>
      <table class="items-table" id="itemsTable">
        <thead>
          <tr>
            <th>‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤</th>
            <th>‡∏Å‡∏ß‡πâ‡∏≤‡∏á (‡∏°.)</th>
            <th>‡∏¢‡∏≤‡∏ß (‡∏°.)</th>
            <th>‡∏•‡∏∂‡∏Å (‡∏°.)</th>
            <th>‡∏Ñ‡∏•‡∏≠‡∏á‡πÑ‡∏™‡πâ‡πÑ‡∏Å‡πà?</th>
            <th>‡∏à‡∏≥‡∏ô‡∏ß‡∏ô</th>
            <th>‡∏•‡∏ö</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
      <button type="button" id="addItem" class="btn-secondary">+ ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£</button>

      <label style="margin-top:14px"><input type="checkbox" id="summarySpecial"> ‡∏à‡∏±‡∏á‡∏´‡∏ß‡∏±‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© (+5 ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°. ‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 1,500 ‡∏ö‡∏≤‡∏ó)</label>
      <label><input type="checkbox" id="summaryDiscount5"> ‡πÉ‡∏ä‡πâ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 5%</label>
      <label><input type="checkbox" id="summaryFactoryBlue"> ‡πÄ‡∏û‡∏à "‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô ‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô" (0.3L=40, 0.5L=50, 0.5H=60, 0.75H=80 ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)</label>

      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à</label>
      <select id="pageSelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏û‡∏à...</option>
        <option value="‡∏™‡πâ‡∏°">‡∏™‡πâ‡∏°</option>
        <option value="‡∏°‡πà‡∏ß‡∏á">‡∏°‡πà‡∏ß‡∏á</option>
        <option value="‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô">‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô</option>
        <option value="‡∏ö‡πà‡∏≠‡πÉ‡∏´‡∏ç‡πà">‡∏ö‡πà‡∏≠‡πÉ‡∏´‡∏ç‡πà</option>
        <option value="‡∏£‡∏ñ‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å">‡∏£‡∏ñ‡∏ö‡∏£‡∏£‡∏ó‡∏∏‡∏Å</option>
        <option value="MP">MP</option>
        <option value="‡πÇ‡∏ó‡∏£">‡πÇ‡∏ó‡∏£</option>
        <option value="‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏ü‡∏™ (‡πÄ‡∏ï‡∏¢)">‡∏Å‡∏•‡∏∏‡πà‡∏°‡πÄ‡∏ü‡∏™ (‡πÄ‡∏ï‡∏¢)</option>
        <option value="PP Dump">PP Dump</option>
        <option value="‡πÄ‡∏ã‡∏ü‡∏ó‡∏£‡∏±‡∏Å">‡πÄ‡∏ã‡∏ü‡∏ó‡∏£‡∏±‡∏Å</option>
        <option value="Line">Line</option>
      </select>

      <label>‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô</label>
      <select id="adminSelect">
        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô...</option>
        <option value="‡∏´‡∏°‡∏¥‡∏ß">‡∏´‡∏°‡∏¥‡∏ß</option>
        <option value="‡πÄ‡∏ï‡∏¢">‡πÄ‡∏ï‡∏¢</option>
        <option value="‡∏à‡πã‡∏≤">‡∏à‡πã‡∏≤</option>
        <option value="‡πÄ‡∏ö‡∏•">‡πÄ‡∏ö‡∏•</option>
        <option value="‡∏´‡∏á‡∏™‡πå">‡∏´‡∏á‡∏™‡πå</option>
        <option value="‡∏†‡∏µ‡∏£‡πå">‡∏†‡∏µ‡∏£‡πå</option>
        <option value="‡∏Å‡∏°‡∏•">‡∏Å‡∏°‡∏•</option>
        <option value="pekky">pekky</option>
        <option value="‡∏û‡∏•‡∏≠‡∏¢">‡∏û‡∏•‡∏≠‡∏¢</option>
        <option value="‡πÅ‡∏à‡∏°">‡πÅ‡∏à‡∏°</option>
        <option value="‡πÉ‡∏¢‡∏ù‡πâ‡∏≤‡∏¢">‡πÉ‡∏¢‡∏ù‡πâ‡∏≤‡∏¢</option>
      </select>

      <button type="submit" class="btn-primary" style="margin-top:20px">‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</button>
    </form>
    <textarea id="summaryResult" readonly style="margin-top:16px"></textarea>
    <button id="summaryCopy" class="copy-btn hidden" style="margin-top:12px">‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°</button>
  </div>

  <script>
    // --- Tab control ---
    const tabs = document.querySelectorAll('.tab');
    const sections = { pond: 'pondContainer', canal: 'canalContainer', circular: 'circularContainer', flatbar: 'flatbarContainer', summary: 'summaryContainer' };
    tabs.forEach(tab => tab.addEventListener('click', () => {
      tabs.forEach(t=>t.classList.remove('active'));
      tab.classList.add('active');
      Object.values(sections).forEach(id=>document.getElementById(id).classList.add('hidden'));
      const target = tab.getAttribute('data-tab');
      document.getElementById(sections[target]).classList.remove('hidden');
      window.scrollTo({top:0,behavior:'smooth'});
    }));

    // --- Pricing helpers ---
    function getPondPriceList(isFactory){
      if(isFactory){ return { '0.3':{price:40, material:'LDPE'}, '0.5':{price:60, material:'HDPE'}, '0.75':{price:80, material:'HDPE'} }; }
      return { '0.3':{price:40, material:'LDPE'}, '0.5':{price:65, material:'HDPE'}, '0.75':{price:85, material:'HDPE'} };
    }

    // ---------- POND LOGIC ----------
    const pondForm = document.getElementById('pondForm');
    const pondWidth = document.getElementById('pondWidth');
    const pondLength = document.getElementById('pondLength');
    const pondDepth = document.getElementById('pondDepth');
    const pondResult = document.getElementById('pondResult');
    const pondCopy = document.getElementById('pondCopy');
    const pondReset = document.getElementById('pondReset');
    const pondSpecialProvince = document.getElementById('pondSpecialProvince');
    const pondDiscount5 = document.getElementById('pondDiscount5');
    const pondFactoryBlue = document.getElementById('pondFactoryBlue');

    pondForm.onsubmit = function(e){
      e.preventDefault();
      const size = document.querySelector('input[name="size"]:checked');
      let w = parseFloat(pondWidth.value), l = parseFloat(pondLength.value), d = parseFloat(pondDepth.value || 0);
      if(!size || w<=0 || l<=0){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'); return; }
      const ow=w, ol=l;
      if(d>0){ w = w + d*2 + 2; l = l + d*2 + 2; }
      const priceList = getPondPriceList(pondFactoryBlue.checked);
      const area = w*l; let text='';
      if(size.value==='all'){
        const p03=Math.floor(area*priceList['0.3'].price), p05=Math.floor(area*priceList['0.5'].price), p075=Math.floor(area*priceList['0.75'].price);
        text += `‡∏à‡∏≤‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏ó‡∏µ‡πà‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÅ‡∏à‡πâ‡∏á‡∏°‡∏≤ ‡∏£‡∏≤‡∏Ñ‡∏≤‡∏î‡∏±‡∏á‡∏ô‡∏µ‡πâ‡∏Ñ‡πà‡∏∞\n`;
        text += `‚úÖ LDPE ‡∏´‡∏ô‡∏≤ 0.3 ‡∏°‡∏°. ‚Äì ${p03.toLocaleString()} ‡∏ö‡∏≤‡∏ó (${priceList['0.3'].price} ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)\n`;
        text += `‚úÖ HDPE ‡∏´‡∏ô‡∏≤ 0.5 ‡∏°‡∏°. ‚Äì ${p05.toLocaleString()} ‡∏ö‡∏≤‡∏ó (${priceList['0.5'].price} ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)\n`;
        text += `‚úÖ HDPE ‡∏´‡∏ô‡∏≤ 0.75 ‡∏°‡∏°. ‚Äì ${p075.toLocaleString()} ‡∏ö‡∏≤‡∏ó (${priceList['0.75'].price} ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)\n\n`;
        text += `‡∏¢‡∏¥‡πà‡∏á‡∏´‡∏ô‡∏≤ ‡∏¢‡∏¥‡πà‡∏á‡∏ó‡∏ô‡∏ó‡∏≤‡∏ô ‡∏ï‡πà‡∏≠‡∏™‡∏†‡∏≤‡∏û‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á‡πÅ‡∏•‡∏∞‡∏û‡∏∑‡πâ‡∏ô‡∏ú‡∏¥‡∏ß‡∏Ç‡∏£‡∏∏‡∏Ç‡∏£‡∏∞`;
        if(pondFactoryBlue.checked){ text += `\n(‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ô‡∏µ‡πâ‡πÄ‡∏õ‡πá‡∏ô‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏à‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)`; }
        text += `\n\n‡∏™‡∏ô‡πÉ‡∏à‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏ô‡∏≤‡πÑ‡∏´‡∏ô‡πÅ‡∏à‡πâ‡∏á‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Ñ‡πà‡∏∞ üòä`;
      }else{
        const sel = priceList[size.value];
        let total = Math.floor(area * sel.price);
        if(pondDiscount5.checked){ total = Math.floor(total * 0.95); }
        let shipping = 0; if(total < 5000) shipping += 300; if(pondSpecialProvince.checked){ shipping += Math.min(Math.floor(5*area), 2000); }
        const sum = Math.floor(total + shipping);
        text += `üìç ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:\n`;
        text += `‡∏ú‡πâ‡∏≤‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å ${sel.material} ‡∏´‡∏ô‡∏≤ ${size.value} ‡∏°‡∏°. (${sel.price} ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)\n`;
        text += `‡∏Ç‡∏ô‡∏≤‡∏î ${ow} ‡∏°. √ó ${ol} ‡∏°.${d>0?` ‡∏•‡∏∂‡∏Å ${d} ‡∏°.`:''}\n`;
        text += `‡∏ú‡πâ‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î ${w} ‡∏°. √ó ${l} ‡∏°. = ${area.toLocaleString()} ‡∏ï‡∏£.‡∏°.\n(‡∏Ç‡∏ô‡∏≤‡∏î‡∏ú‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏±‡∏î‡πÅ‡∏ô‡∏ö‡∏û‡∏∑‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏ö‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡∏∞ 1 ‡πÄ‡∏°‡∏ï‡∏£‡πÅ‡∏•‡πâ‡∏ß)\n\n`;
        if(shipping>0){ text += `‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ú‡πâ‡∏≤ ${total.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á ${shipping.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`; }
        text += `üìå ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${sum.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
        if(pondFactoryBlue.checked) text += `(‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏à‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)\n`;
        if(pondDiscount5.checked) text += `(‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 5%)\n`;
        text += `‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞ ‚ú®\n‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞\n\n`;
        if(shipping<=0) text += `(‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏∞)`;
        if(sum>=5000){ const dep=Math.floor(sum*0.1), bal=Math.floor(sum-dep); text += `\n‚úÖ ‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 10% (${dep.toLocaleString()} ‡∏ö‡∏≤‡∏ó) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠\n\nüì¶ ‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠-‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà & ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå\nüöö ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 4-6 ‡∏ß‡∏±‡∏ô\nCOD ${bal.toLocaleString()} ‡∏ö‡∏≤‡∏ó ‡πÇ‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏∞ üòâ\n`; }
        else{ text += `‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠-‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà & ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏Ñ‡πà‡∏∞\nüöö ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 4-6 ‡∏ß‡∏±‡∏ô\nCOD ${sum.toLocaleString()} ‡∏ö‡∏≤‡∏ó ‡πÇ‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏∞ üòâ\n`; }
      }
      pondResult.value = text.trim(); pondCopy.classList.remove('hidden'); pondReset.classList.remove('hidden');
    };
    pondCopy.onclick = ()=>{ pondResult.select(); document.execCommand('copy'); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß'); };
    pondReset.onclick = ()=>{ pondForm.reset(); pondResult.value=''; pondCopy.classList.add('hidden'); pondReset.classList.add('hidden'); };

    // ---------- CANAL LOGIC ----------
    const canalForm = document.getElementById('canalForm');
    const canalWidth = document.getElementById('canalWidth');
    const canalLength = document.getElementById('canalLength');
    const canalDepth = document.getElementById('canalDepth');
    const canalResult = document.getElementById('canalResult');
    const canalCopy = document.getElementById('canalCopy');
    const canalReset = document.getElementById('canalReset');
    const canalSizeRadios = document.querySelectorAll('input[name="canalSize"]');
    const canalSpecialProvince = document.getElementById('canalSpecialProvince');
    const canalDiscount5 = document.getElementById('canalDiscount5');
    const canalFactoryBlue = document.getElementById('canalFactoryBlue');

    canalSizeRadios.forEach(r=>r.addEventListener('change',()=>{ if(r.value==='0.5'){ canalWidth.value=4; canalWidth.disabled=true; } else { canalWidth.disabled=false; } }));

    canalForm.onsubmit = function(e){
      e.preventDefault();
      const size = document.querySelector('input[name="canalSize"]:checked');
      let w = parseFloat(canalWidth.value), l = parseFloat(canalLength.value), d = parseFloat(canalDepth.value || 0);
      if(!size || w<=0 || l<=0){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡πÅ‡∏•‡∏∞‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á'); return; }
      const ow=w, ol=l; if(d>0){ w=w + d*2 + 1; l=l + d*2 + 1; }
      const basePrice = 60; const pricePerSqm = (canalFactoryBlue && canalFactoryBlue.checked) ? 50 : basePrice; const mat = 'LDPE';

      const area = w*l; let total = Math.floor(area * pricePerSqm);
      let discountAmount=0; if(canalDiscount5.checked){ discountAmount = Math.floor(total*0.05); total -= discountAmount; }
      let shipping = total<5000 ? 300 : 0; if(canalSpecialProvince.checked){ shipping += Math.floor(5*area); }
      const sum = Math.floor(total + shipping);

      let text = `üìç ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£:\n`;
      text += `‡∏ú‡πâ‡∏≤‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å ${mat} ‡∏´‡∏ô‡∏≤ 0.5 ‡∏°‡∏°. (${pricePerSqm} ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)\n`;
      text += `‡∏Ç‡∏ô‡∏≤‡∏î ${ow} ‡∏°. √ó ${ol} ‡∏°.${d>0?` ‡∏•‡∏∂‡∏Å ${d} ‡∏°.`:''} = ${area.toLocaleString()} ‡∏ï‡∏£.‡∏°.\n(‡∏Ç‡∏ô‡∏≤‡∏î‡∏ú‡πâ‡∏≤‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏ß‡∏±‡∏î‡πÅ‡∏ô‡∏ö‡∏û‡∏∑‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡πÄ‡∏ú‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏ö‡∏Ç‡πâ‡∏≤‡∏á‡∏•‡∏∞ 0.5 ‡πÄ‡∏°‡∏ï‡∏£‡πÅ‡∏•‡πâ‡∏ß)\n\n`;
      text += `üìå ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î: ${sum.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
      if(canalFactoryBlue && canalFactoryBlue.checked){ text += `(‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏à‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)\n`; }
      if(canalDiscount5.checked){ text += `(‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 5% = ${discountAmount.toLocaleString()} ‡∏ö‡∏≤‡∏ó)\n`; }
      text += `‡∏£‡∏ö‡∏Å‡∏ß‡∏ô‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ô‡∏∞‡∏Ñ‡∏∞ ‚ú®\n‡∏´‡∏≤‡∏Å‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏•‡∏¥‡∏ï‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡πÑ‡∏î‡πâ‡∏Ñ‡πà‡∏∞\n\n`;
      if(shipping>0){ text += `‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ú‡πâ‡∏≤ ${total.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏£‡∏ß‡∏° ${shipping.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`; } else { text += `(‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏∞)\n`; }
      text += `‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° ${sum.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n\n`;
      if(sum>=5000){ const dep=Math.floor(sum*0.1), bal=Math.floor(sum-dep); text += `‚úÖ ‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 10% (${dep.toLocaleString()} ‡∏ö‡∏≤‡∏ó) ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠\n\nüì¶ ‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠-‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà & ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå\nüöö ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 4-6 ‡∏ß‡∏±‡∏ô\nCOD ${bal.toLocaleString()} ‡∏ö‡∏≤‡∏ó ‡πÇ‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏∞ üòâ\n`; }
      else { text += `‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡πÅ‡∏•‡πâ‡∏ß‡πÅ‡∏à‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠-‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà & ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå‡∏Ñ‡πà‡∏∞\nüöö ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 4-6 ‡∏ß‡∏±‡∏ô\nCOD ${sum.toLocaleString()} ‡∏ö‡∏≤‡∏ó ‡πÇ‡∏≠‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏∞ üòâ\n`; }

      canalResult.value = text.trim(); canalCopy.classList.remove('hidden'); canalReset.classList.remove('hidden');
    };
    canalCopy.onclick = ()=>{ canalResult.select(); document.execCommand('copy'); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß'); };
    canalReset.onclick = ()=>{ canalForm.reset(); canalWidth.disabled=false; canalResult.value=''; canalCopy.classList.add('hidden'); canalReset.classList.add('hidden'); };

    // ---------- CIRCULAR LOGIC ----------
    const circularForm = document.getElementById('circularForm');
    const circularResult = document.getElementById('circularResult');
    const circularCopy = document.getElementById('circularCopy');
    const circularReset = document.getElementById('circularReset');
    window.circularInfo = { '6':{volume:34000, price:35000}, '8':{volume:60000, price:50000}, '10':{volume:95000, price:63000}, '12':{volume:135000, price:72000} };

    circularForm.onsubmit = function(e){
      e.preventDefault();
      const dia = document.querySelector('input[name="circleDiameter"]:checked');
      if(!dia){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏Ç‡∏ô‡∏≤‡∏î‡∏ö‡πà‡∏≠‡∏Å‡∏•‡∏°'); return; }
      const data = window.circularInfo[dia.value];
      let text = `üìå ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (‡∏ö‡πà‡∏≠‡∏Å‡∏•‡∏°)\n`;
      text += `‡∏ö‡πà‡∏≠‡∏Å‡∏•‡∏° ‡πÄ‡∏°‡∏ó‡∏±‡∏•‡∏ä‡∏µ‡∏ó‡∏ö‡∏•‡∏π‡∏™‡πÇ‡∏Ñ‡∏õ ‡∏™‡∏π‡∏á 1.2 ‡∏°. ‡πÄ‡∏™‡πâ‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏®‡∏π‡∏ô‡∏¢‡πå‡∏Å‡∏•‡∏≤‡∏á ${dia.value} ‡πÄ‡∏°‡∏ï‡∏£\n`;
      text += `‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∏‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì ${data.volume.toLocaleString()} ‡∏•‡∏¥‡∏ï‡∏£\n‡∏£‡∏≤‡∏Ñ‡∏≤ ${data.price.toLocaleString()} ‡∏ö‡∏≤‡∏ó\n`;
      text += data.price>=80000?`\n‡∏™‡∏±‡πà‡∏á‡πÄ‡∏Å‡∏¥‡∏ô 80,000 ‡∏™‡πà‡∏á‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏ü‡∏£‡∏µ!`:`\n(‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á ‡∏Ñ‡∏¥‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏≤‡∏á)`;
      text += `\n\n‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠`;
      circularResult.value = text.trim(); circularCopy.classList.remove('hidden'); circularReset.classList.remove('hidden');
    };
    circularCopy.onclick = ()=>{ circularResult.select(); document.execCommand('copy'); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß'); };
    circularReset.onclick = ()=>{ circularForm.reset(); circularResult.value=''; circularCopy.classList.add('hidden'); circularReset.classList.add('hidden'); };

    // ---------- FLATBAR LOGIC (‡∏ú‡πâ‡∏≤‡∏≠‡∏¢‡∏π‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏ö‡∏ô + ‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö) ----------
    const flatbarForm = document.getElementById('flatbarForm');
    const flatbarResult = document.getElementById('flatbarResult');
    const flatbarCopy = document.getElementById('flatbarCopy');
    const flatbarReset = document.getElementById('flatbarReset');
    const flatbarItemsBody = document.querySelector('#flatbarItemsTable tbody');
    const addFlatbarRowBtn = document.getElementById('addFlatbarRow');
    const hasFrontEl = document.getElementById('hasFrontCloth');

    const clothTableBody = document.querySelector('#clothTableFlatbar tbody');
    const btnAddCloth = document.getElementById('flatbarAddCloth');

    const CLOTH_PRESETS = { '4x3':2400, '4x3.5':2800, '6x3.5':4200, '6x4':4800, '7x3.5':4900, '7x4':5600, '8x4':6500, '8x5':8500 };
    const PRESET_SIZES = { '4x3':{w:4,l:3}, '4x3.5':{w:4,l:3.5}, '6x3.5':{w:6,l:3.5}, '6x4':{w:6,l:4}, '7x3.5':{w:7,l:3.5}, '7x4':{w:7,l:4}, '8x4':{w:8,l:4}, '8x5':{w:8,l:5} };

    function makeClothRow(defaultType='custom'){
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>
          <select class="ptype">
            <option value="custom" selected>‡∏£‡∏∞‡∏ö‡∏∏‡πÄ‡∏≠‡∏á</option>
            <option value="4x3">4 ‡∏°. √ó 3 ‡∏°. ‚Äî 2,400</option>
            <option value="4x3.5">4 ‡∏°. √ó 3.5 ‡∏°. ‚Äî 2,800</option>
            <option value="6x3.5">6 ‡∏°. √ó 3.5 ‡∏°. ‚Äî 4,200</option>
            <option value="6x4">6 ‡∏°. √ó 4 ‡∏°. ‚Äî 4,800</option>
            <option value="7x3.5">7 ‡∏°. √ó 3.5 ‡∏°. ‚Äî 4,900</option>
            <option value="7x4">7 ‡∏°. √ó 4 ‡∏°. ‚Äî 5,600</option>
            <option value="8x4">8 ‡∏°. √ó 4 ‡∏°. ‚Äî 6,500</option>
            <option value="8x5">8 ‡∏°. √ó 5 ‡∏°. ‚Äî 8,500</option>
          </select>
        </td>
        <td><input type="number" class="cw" step="0.1" min="0.1" placeholder="‡∏Å‡∏ß‡πâ‡∏≤‡∏á (‡∏°.)"></td>
        <td><input type="number" class="cl" step="0.1" min="0.1" placeholder="‡∏¢‡∏≤‡∏ß (‡∏°.)"></td>
        <td><input type="number" class="cq" value="1" min="1"></td>
        <td><button type="button" class="btn-danger del">‡∏•‡∏ö</button></td>`;
      const sel = tr.querySelector('.ptype'); const cw = tr.querySelector('.cw'); const cl = tr.querySelector('.cl'); const delBtn = tr.querySelector('.del');
      function applyType(){ const val = sel.value; if(val!=='custom'){ const s = PRESET_SIZES[val]; cw.value=s.w; cl.value=s.l; cw.disabled=true; cl.disabled=true; } else { cw.disabled=false; cl.disabled=false; } }
      sel.addEventListener('change', applyType);
      delBtn.addEventListener('click', ()=> tr.remove());
      sel.value = defaultType; applyType();
      clothTableBody.appendChild(tr);
    }
    btnAddCloth.addEventListener('click', ()=> makeClothRow('custom'));
    makeClothRow('custom');

    // --- FLATBAR items (multiple rows) ---
   function makeFlatbarRow(len=4, width=2.4, qty=1){
  const tr = document.createElement('tr');
  tr.innerHTML = `
    <td><input type="number" class="flen"   step="0.1" min="2"   placeholder="‡πÄ‡∏ä‡πà‡∏ô 4"   value="${len}"></td>
    <td><input type="number" class="fwidth" step="0.1" min="0.5" placeholder="‡πÄ‡∏ä‡πà‡∏ô 2.5" value="${width}"></td>
    <td><input type="number" class="fqty"   step="1"   min="1"   value="${qty}"></td>
    <td><button type="button" class="btn-danger fdel">‡∏•‡∏ö</button></td>`;
  tr.querySelector('.fdel').onclick = ()=> tr.remove();
  flatbarItemsBody.appendChild(tr);
}
    addFlatbarRowBtn.addEventListener('click', ()=> makeFlatbarRow());
    makeFlatbarRow();

   function collectFlatbarItems(){
  const rows = [...flatbarItemsBody.querySelectorAll('tr')];
  const items = [];
  for(const tr of rows){
    const L = parseFloat(tr.querySelector('.flen')?.value);
    const W = parseFloat(tr.querySelector('.fwidth')?.value);
    const q = Math.max(1, parseInt(tr.querySelector('.fqty')?.value||1,10));
    if(Number.isFinite(L) && L>=2 && Number.isFinite(W) && W>0){
      items.push({L, W, qty:q});
    }
  }
  return items;
}

    function collectCloth(){
      const rows = [...clothTableBody.querySelectorAll('tr')];
      let has=false, price=0; let lines=[]; let simple=[];
      for(const tr of rows){
        const type = tr.querySelector('.ptype').value;
        const cw = parseFloat(tr.querySelector('.cw').value||0);
        const cl = parseFloat(tr.querySelector('.cl').value||0);
        const qty = Math.max(1, parseInt(tr.querySelector('.cq').value||1,10));
        if(type!=='custom'){
          const u = CLOTH_PRESETS[type]||0; const s = PRESET_SIZES[type]; const sum = u*qty; price+=sum; has = has || sum>0;
          lines.push(`‡∏Ç‡∏ô‡∏≤‡∏î ${s.w}x${s.l}${qty>1?` √ó ${qty}`:''} ‡∏£‡∏≤‡∏Ñ‡∏≤ ${sum.toLocaleString()} ‡∏ö‡∏≤‡∏ó`); simple.push({w:s.w,l:s.l,qty,sum});
        }else{
          if(!(cw>0 && cl>0)) continue; const area=cw*cl; const unit=Math.floor(area*250); const sum=unit*qty; price+=sum; has = has || sum>0;
          lines.push(`‡∏Ç‡∏ô‡∏≤‡∏î ${cw}x${cl}${qty>1?` √ó ${qty}`:''} ‡∏£‡∏≤‡∏Ñ‡∏≤ ${sum.toLocaleString()} ‡∏ö‡∏≤‡∏ó`); simple.push({w:cw,l:cl,qty,sum});
        }
      }
      return {has, text: lines.join('\n'), price, simple};
    }

   function pickBars(len){
  const L = Number(len);
  if(!Number.isFinite(L) || L < 2) return null;

  // ‡πÉ‡∏ä‡πâ‡πÄ‡∏´‡∏•‡πá‡∏Å 4 ‡∏Ç‡∏ô‡∏≤‡∏î ‡πÅ‡∏•‡∏∞ "‡∏õ‡∏±‡∏î‡∏•‡∏á" (‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏à‡∏£‡∏¥‡∏á), ‡∏û‡∏¢‡∏≤‡∏¢‡∏≤‡∏°‡πÉ‡∏´‡πâ‡∏ú‡∏•‡∏£‡∏ß‡∏°‡∏¢‡∏≤‡∏ß‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
  const sizes = [3.5, 3, 2.5, 2]; // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏á‡πà‡∏≤‡∏¢‡∏ï‡πà‡∏≠‡∏Å‡∏≤‡∏£‡∏ß‡∏ô‡∏´‡∏≤
  // ‡πÄ‡∏Å‡πá‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î: sum = ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ, counts = [2m, 2.5m, 3m, 3.5m]
  let best = { sum: 0, counts: [0, 0, 0, 0] };

  const maxD = Math.floor(L / sizes[0]); // 3.5
  for (let d = 0; d <= maxD; d++) {
    const lenD = d * sizes[0];

    const maxC = Math.floor((L - lenD) / sizes[1]); // 3.0
    for (let c = 0; c <= maxC; c++) {
      const lenC = lenD + c * sizes[1];
      if (lenC > L) break;

      const maxB = Math.floor((L - lenC) / sizes[2]); // 2.5
      for (let b = 0; b <= maxB; b++) {
        const lenB = lenC + b * sizes[2];
        if (lenB > L) break;

        // ‡πÄ‡∏ï‡∏¥‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏î‡πâ‡∏ß‡∏¢ 2 ‡∏°. (‡∏õ‡∏±‡∏î‡∏•‡∏á)
        const a = Math.floor((L - lenB) / sizes[3]); // 2.0
        const sum = lenB + a * sizes[3];

        // tie-break: 1) sum ‡∏°‡∏≤‡∏Å‡∏Å‡∏ß‡πà‡∏≤ ‡∏ä‡∏ô‡∏∞  2) ‡∏ä‡∏¥‡πâ‡∏ô‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤ ‡∏ä‡∏ô‡∏∞  3) ‡∏ä‡∏≠‡∏ö‡πÉ‡∏ä‡πâ 3 ‡∏°. ‡πÅ‡∏•‡πâ‡∏ß‡∏Ñ‡πà‡∏≠‡∏¢ 2.5 ‡∏°.
        const bars = a + b + c + d;
        const bestBars = best.counts[0] + best.counts[1] + best.counts[2] + best.counts[3];
        const preferScore = (c * 100 + b * 10) - (best.counts[2] * 100 + best.counts[1] * 10);

        if (
          sum > best.sum ||
          (sum === best.sum && bars < bestBars) ||
          (sum === best.sum && bars === bestBars && preferScore > 0)
        ) {
          // ‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏õ‡πá‡∏ô [2m, 2.5m, 3m, 3.5m]
          best = { sum, counts: [a, b, c, d] };
        }
      }
    }
  }

  const [a2, b25, c3, d35] = best.counts; // mapping ‡∏ä‡∏±‡∏î‡πÄ‡∏à‡∏ô
  return { b2: a2, b25, b3: c3, b35: d35, used: best.sum };
}

   function calcFlatbarAggregate(items, hasFront=false){
  // ‡∏£‡∏ß‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô: ‡∏Ñ‡∏π‡∏ì‡∏ó‡∏±‡πâ‡∏á "‡∏£‡∏≤‡∏Ñ‡∏≤" ‡πÅ‡∏•‡∏∞ "‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏™‡πâ‡∏ô" ‡∏î‡πâ‡∏ß‡∏¢‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Ñ‡∏±‡∏ô
  let totalB2=0, totalB25=0, totalB3=0, totalB35=0;
  let totalLen=0, totalPrice=0, totalCars=0;
  const lines=[];
  const points = 4; // ‡∏ï‡πà‡∏≠‡∏à‡∏∏‡∏î‡∏Ñ‡∏π‡∏ì 4 ‡∏à‡∏∏‡∏î

  for (const {L, W, qty} of items){
  const seg = pickBars(L); if(!seg) continue;

  const per2   = seg.b2  * points;
  const per25  = seg.b25 * points;
  const per3   = seg.b3  * points;
  const per35  = seg.b35 * points;

  // ‡πÄ‡∏î‡∏¥‡∏°:
  // const perLen = L * points;
  // const priceLen = perLen * 50;

  // ‡πÉ‡∏´‡∏°‡πà: ‡∏Ñ‡∏¥‡∏î‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ï‡∏≤‡∏°‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà ‚Äú‡πÉ‡∏´‡πâ‡∏à‡∏£‡∏¥‡∏á‚Äù (seg.used)
  const perLenUsed = seg.used * points;   // ‡πÄ‡∏°‡∏ï‡∏£/‡∏Ñ‡∏±‡∏ô ‡∏à‡∏≤‡∏Å‡∏ä‡∏∏‡∏î‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏ó‡∏µ‡πà‡∏ï‡∏±‡∏î‡∏à‡∏£‡∏¥‡∏á
  const priceLen   = perLenUsed * 50;

  const priceHeadTail = (W * 2) * 50;     // ‡πÄ‡∏ó‡πà‡∏≤‡πÄ‡∏î‡∏¥‡∏°: ‡∏Å‡∏ß‡πâ‡∏≤‡∏á√ó2 ‡∏î‡πâ‡∏≤‡∏ô √ó 50
  const unitPrice     = priceLen + priceHeadTail + (hasFront ? 150 : 0);

  totalB2  += per2  * qty;
  totalB25 += per25 * qty;
  totalB3  += per3  * qty;
  totalB35 += per35 * qty;

  // ‡πÄ‡∏î‡∏¥‡∏°: totalLen += perLen * qty;
  totalLen += perLenUsed * qty;

  totalPrice += unitPrice * qty;
  totalCars  += qty;

  lines.push(`‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏≤‡∏ß‡∏£‡∏ñ ${L} ‡πÄ‡∏°‡∏ï‡∏£ ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á ${W} ‡πÄ‡∏°‡∏ï‡∏£${qty>1?` ‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${qty} ‡∏Ñ‡∏±‡∏ô`:''}`);
}


  if(lines.length===0){
    return { text:'', totalTwo:0, totalThree:0, totalLen:0, totalPrice:0, itemsLine:'' };
  }

  const parts=[];
  if(totalB2  > 0) parts.push(`‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô 2 ‡∏°. √ó ${totalB2} ‡πÄ‡∏™‡πâ‡∏ô`);
  if(totalB25 > 0) parts.push(`‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô 2.5 ‡∏°. √ó ${totalB25} ‡πÄ‡∏™‡πâ‡∏ô`);
  if(totalB3  > 0) parts.push(`‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô 3 ‡∏°. √ó ${totalB3} ‡πÄ‡∏™‡πâ‡∏ô`);
  if(totalB35 > 0) parts.push(`‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô 3.5 ‡∏°. √ó ${totalB35} ‡πÄ‡∏™‡πâ‡∏ô`);
  const itemsLine = parts.join(', ');

  // show ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏ß‡πâ‡∏≤‡∏á‡πÉ‡∏ô‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏ (‡∏£‡∏ß‡∏°‡∏Ñ‡πà‡∏≤‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥)
  const uniqueW = [...new Set(items.map(x => x.W).filter(w => Number.isFinite(w)))];
  const widthNote = uniqueW.length === 1
    ? ` ${uniqueW[0]} ‡∏°.`
    : (uniqueW.length > 1 ? ` ${uniqueW.map(w => w + ' ‡∏°.').join(', ')}` : '');

  // ‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏´‡∏±‡∏ß-‡∏ó‡πâ‡∏≤‡∏¢ (‡∏ä‡∏¥‡πâ‡∏ô) ‡∏ï‡πà‡∏≠‡∏Ñ‡∏±‡∏ô: ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ú‡πâ‡∏≤‡∏Ç‡∏∂‡πâ‡∏ô‡∏´‡∏ô‡πâ‡∏≤ = 2 ‡∏ä‡∏¥‡πâ‡∏ô/‡∏Ñ‡∏±‡∏ô, ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ = 3 ‡∏ä‡∏¥‡πâ‡∏ô/‡∏Ñ‡∏±‡∏ô
  const remarkPerCar = hasFront ? 3 : 2;
  const remarkTotal  = remarkPerCar * (totalCars || 1);

  const header = `üì¶ ‡∏ä‡∏∏‡∏î‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á MP Flow 2.0 `;
  const body = `\n${lines.join('\n')}\n‡∏™‡∏¥‡πà‡∏á‡∏ó‡∏µ‡πà‡∏à‡∏∞‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö : ${itemsLine} , ‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏±‡∏ß‡∏ó‡πâ‡∏≤‡∏¢ 2.4 ‡∏°. √ó ${remarkTotal} ‡πÄ‡∏™‡πâ‡∏ô ‡πÄ‡∏´‡∏•‡πá‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á‡∏°‡∏∏‡∏° 0.6 ‡∏°. x 4 ‡πÄ‡∏™‡πâ‡∏ô ‡πÅ‡∏•‡∏∞‡∏™‡∏Å‡∏£‡∏π‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡πÅ‡∏•‡πâ‡∏ß
‡∏¢‡∏≠‡∏î‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô ${totalPrice.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
  return { text: header + body, totalTwo: totalB2, totalThree: totalB3, totalLen, totalPrice, itemsLine };
};


    flatbarForm.onsubmit = function(e){
      e.preventDefault();
      const cloth = collectCloth(); if(!cloth.has){ alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ú‡πâ‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‡πÅ‡∏•‡∏∞‡∏Å‡∏£‡∏≠‡∏Å‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô'); return; }
      const cust = (document.getElementById('flatbarCustInfo').value||'').trim();
      const fbName = (document.getElementById('flatbarFacebook').value||'').trim();
      const page = document.getElementById('flatbarPageSelect').value;
      const admin = document.getElementById('flatbarAdminSelect').value;
      const dateText = (document.getElementById('flatbarDate').value||'').trim();

      // ‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö, ‡∏´‡∏•‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ)
      const items = collectFlatbarItems();
      const kit = items.length ? calcFlatbarAggregate(items, hasFrontEl.checked) : null;

      // ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏£‡∏∏‡∏õ‡∏ï‡∏≤‡∏°‡∏ü‡∏≠‡∏£‡πå‡πÅ‡∏°‡∏ï‡∏ó‡∏µ‡πà‡∏Ç‡∏≠
      let out = '‡∏™‡πà‡∏á';
      if(cust) out += `
${cust}`;
      out += `

MP Flow 2.0 HDPE ‡∏´‡∏ô‡∏≤ 2 ‡∏°‡∏¥‡∏•`;
      out += `
${cloth.text}`;

      if(kit && kit.text){ out += `

${kit.text}`; }

      // ‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢ (‡∏°‡∏µ‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î 5% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡πâ‡∏≤ ‡∏ñ‡πâ‡∏≤‡∏ï‡∏¥‡πä‡∏Å)
      const applyDisc = document.getElementById('flatbarDiscount5').checked;
      const clothBase = cloth.price;
      const discAmt = applyDisc ? Math.floor(clothBase * 0.05) : 0;
      const clothSum = clothBase - discAmt;
      const steelSum = kit? kit.totalPrice : 0;
      let subtotal = clothSum + steelSum;

      // ‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á: ‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤ 2,000 ‡∏°‡∏µ‡∏Ñ‡πà‡∏≤‡∏™‡πà‡∏á 300
      const ship = subtotal < 2000 ? 300 : 0;
      const grand = subtotal + ship;

      // ‡∏°‡∏±‡∏î‡∏à‡∏≥ 10% ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏°‡πÄ‡∏Å‡∏¥‡∏ô 5,000
      let dep = 0; if(grand>5000){ dep = Math.floor(grand*0.1); }
      const cod = grand - dep;

      if(discAmt>0){
        out += `

(‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 5% ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ú‡πâ‡∏≤ = ${discAmt.toLocaleString()} ‡∏ö‡∏≤‡∏ó)`;
      }
      if(ship>0){
        out += `

‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á ${ship.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
      }

      out += `

‡∏£‡∏ß‡∏°‡∏¢‡∏≠‡∏î‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (MP Flow + ‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô) ${grand.toLocaleString()} ‡∏ö‡∏≤‡∏ó`;
      out += `

‡πÇ‡∏≠‡∏ô‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤
‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏™‡∏¥‡∏Å‡∏£‡πÑ‡∏ó‡∏¢
‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:‡∏ö‡∏£‡∏¥‡∏©‡∏±‡∏ó‡∏°‡∏ô‡∏π‡∏ò‡∏£‡∏£‡∏°‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å
‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà:1888-5999-39 `;
      if(dep>0) out += `
‡∏°‡∏±‡∏î‡∏à‡∏≥ 10% (${dep.toLocaleString()} ‡∏ö‡∏≤‡∏ó)`;
      out += `
COD ${cod.toLocaleString()}`;

      if(fbName) out += `

Facebook ${fbName}`; if(page) out += `
‡πÄ‡∏û‡∏à${page}`; if(admin) out += `
‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô ${admin}`; if(dateText) out += `
${dateText}`;

      flatbarResult.value = out.trim(); flatbarCopy.classList.remove('hidden'); flatbarReset.classList.remove('hidden');
    };
    document.getElementById('flatbarCopy').onclick = ()=>{ flatbarResult.select(); document.execCommand('copy'); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡πÅ‡∏•‡πâ‡∏ß'); };
    flatbarReset.onclick = ()=>{
      flatbarForm.reset();
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡πâ‡∏≤
      clothTableBody.innerHTML='';
      makeClothRow('custom');
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô
      flatbarItemsBody.innerHTML='';
      makeFlatbarRow();
      // ‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
      flatbarResult.value='';
      flatbarCopy.classList.add('hidden');
      flatbarReset.classList.add('hidden');
    };

    // ---------- SUMMARY LOGIC (‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏´‡∏•‡πá‡∏Å‡πÅ‡∏ö‡∏ô) ----------
    const tbody = document.querySelector('#itemsTable tbody');
    const addRow = () => { const tr = document.createElement('tr'); tr.innerHTML = `
        <td><select class="t">
          <option value="0.3L">LDPE 0.3</option>
          <option value="0.5L">LDPE 0.5</option>
          <option value="0.5H">HDPE 0.5</option>
          <option value="0.75H">HDPE 0.75</option>
        </select></td>
        <td><input class="w" type="number" step="0.01"></td>
        <td><input class="l" type="number" step="0.01"></td>
        <td><input class="d" type="number" step="0.01"></td>
        <td><input type="checkbox" class="canal"></td>
        <td><input class="q" type="number" value="1" min="1"></td>
        <td><button type="button" class="btn-danger del">‡∏•‡∏ö</button></td>`; tr.querySelector('.del').onclick = () => tr.remove(); tbody.appendChild(tr); };
    addRow(); document.getElementById('addItem').onclick = addRow;

    document.getElementById('summaryForm').onsubmit = (e)=>{
      e.preventDefault();
      const cust = document.getElementById('custInfo').value.trim();
      const useFactory = document.getElementById('summaryFactoryBlue').checked; const useDiscount = document.getElementById('summaryDiscount5').checked;
      const PRICE = useFactory ? { '0.3L':40, '0.5L':50, '0.5H':60, '0.75H':80 } : { '0.3L':40, '0.5L':60, '0.5H':65, '0.75H':85 };
      const MAT = c => c.endsWith('L')?'LDPE':'HDPE'; const THK = c => c.replace(/[LH]$/, ''); const fmt = n => Math.floor(n).toLocaleString();

      let total=0, areaSum=0, list='', idx=1; tbody.querySelectorAll('tr').forEach(tr=>{ const code = tr.querySelector('.t').value; const w = parseFloat(tr.querySelector('.w').value||0); const l = parseFloat(tr.querySelector('.l').value||0); const d = parseFloat(tr.querySelector('.d').value||0); const q = parseInt(tr.querySelector('.q').value||1); const isCanal = tr.querySelector('.canal').checked; if(w<=0 || l<=0 || q<=0) return; let aw=w, al=l; if(d>0){ const pad=isCanal?1:2; aw=w+d*2+pad; al=l+d*2+pad; } let pricePer = PRICE[code]; if(isCanal) pricePer = Math.floor(pricePer * 1.05); const area = aw*al; const cost = Math.floor(area * pricePer * q); total += cost; areaSum += area*q; list += `üìç ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ${idx}:\n‡∏ú‡πâ‡∏≤‡∏û‡∏•‡∏≤‡∏™‡∏ï‡∏¥‡∏Å ${MAT(code)} ‡∏´‡∏ô‡∏≤ ${THK(code)} ‡∏°‡∏°. (${pricePer} ‡∏ö‡∏≤‡∏ó/‡∏ï‡∏£.‡∏°.)\n‡∏ú‡πâ‡∏≤‡∏Ç‡∏ô‡∏≤‡∏î ${aw} √ó ${al} ‡∏°. = ${fmt(area)} ‡∏ï‡∏£.‡∏°.\n‡∏£‡∏≤‡∏Ñ‡∏≤‡∏ú‡πâ‡∏≤ ${fmt(cost)} ‡∏ö‡∏≤‡∏ó\n`; if(q>1) list += `‡∏à‡∏≥‡∏ô‡∏ß‡∏ô ${q} ‡∏ú‡∏∑‡∏ô\n`; idx++; });
      if(total===0) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 1 ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£');
      let discountAmount=0; if(useDiscount){ discountAmount=Math.floor(total*0.05); total-=discountAmount; }
      let ship = total<5000?300:0; if(document.getElementById('summarySpecial').checked){ const ex=Math.floor(areaSum*5); ship += ex>2000?2000:ex; }
      const grand = Math.floor(total+ship); const dep = grand>=5000?Math.floor(grand*0.1):0; const bal = grand-dep;

      let out = cust?`‡∏™‡πà‡∏á\n${cust}\n\n${list}`:list; out += `üìå ‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏™‡∏±‡πà‡∏á‡∏ã‡∏∑‡πâ‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î\n‡∏¢‡∏≠‡∏î‡∏£‡∏ß‡∏° ${fmt(grand)} ‡∏ö‡∏≤‡∏ó\n`; if(useFactory) out += `(‡∏£‡∏≤‡∏Ñ‡∏≤‡πÇ‡∏£‡∏á‡∏á‡∏≤‡∏ô ‡πÄ‡∏û‡∏à‡∏ô‡πâ‡∏≥‡πÄ‡∏á‡∏¥‡∏ô)\n`; if(useDiscount) out += `(‡∏™‡πà‡∏ß‡∏ô‡∏•‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏© 5% = ${fmt(discountAmount)} ‡∏ö‡∏≤‡∏ó)\n`; out += ship?`‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á ${fmt(ship)} ‡∏ö‡∏≤‡∏ó\n`:'‡∏™‡πà‡∏á‡∏ü‡∏£‡∏µ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡∏≠‡∏á‡∏Ñ‡πà‡∏∞\n\n'; if(dep) out += `‚úÖ ‡∏ä‡∏≥‡∏£‡∏∞‡∏°‡∏±‡∏î‡∏à‡∏≥ 10% (${fmt(dep)} ‡∏ö‡∏≤‡∏ó)`; out += `\n COD ${fmt(bal)} ‡∏ö‡∏≤‡∏ó\n\n`; out += `üöö ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏à‡∏∞‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡∏†‡∏≤‡∏¢‡πÉ‡∏ô 4-6 ‡∏ß‡∏±‡∏ô`;
      const page = document.getElementById('pageSelect').value; const admin = document.getElementById('adminSelect').value; if(page) out += `\n\n‡πÄ‡∏û‡∏à: ${page}`; if(admin) out += `\n‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô: ${admin}`;
      document.getElementById('summaryResult').value = out.trim(); document.getElementById('summaryCopy').classList.remove('hidden');
    };
    document.getElementById('summaryCopy').onclick = ()=>{ const t=document.getElementById('summaryResult'); t.select(); document.execCommand('copy'); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡πÅ‡∏•‡πâ‡∏ß'); };

    // --- quick smoke tests ---
    (function runTests(){
      console.log('[TEST] pondWidth exist =>', !!document.getElementById('pondWidth'));
      console.log('[TEST] canal Blue=50 OK =>', !!document.getElementById('canalFactoryBlue'));
  console.log('[TEST] summary Blue map =>', !!document.getElementById('summaryFactoryBlue'));
      console.log('[TEST] flatbar tab exist =>', !!document.getElementById('flatbarContainer'));
      console.log('[TEST] collectCloth join newline =>', (collectCloth().text!==undefined));
      // sanity: flatbar base for 5m no front cloth => 1300
      const base5 = (300 + (4*5*50)); console.log('[TEST] flatbar 5m base =>', base5);
    })();
  </script>
</body>
</html>

